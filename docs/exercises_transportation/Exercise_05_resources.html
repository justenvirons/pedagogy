<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="C. Scott Smith, PhD AICP (Instructor)">
<meta name="dcterms.date" content="2024-03-06">

<title>GEO 3/430 Exercise #5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="Exercise_05_resources_files/libs/clipboard/clipboard.min.js"></script>
<script src="Exercise_05_resources_files/libs/quarto-html/quarto.js"></script>
<script src="Exercise_05_resources_files/libs/quarto-html/popper.min.js"></script>
<script src="Exercise_05_resources_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Exercise_05_resources_files/libs/quarto-html/anchor.min.js"></script>
<link href="Exercise_05_resources_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Exercise_05_resources_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Exercise_05_resources_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Exercise_05_resources_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Exercise_05_resources_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="Exercise_05_resources_files/libs/quarto-contrib/videojs/video.min.js"></script>
<link href="Exercise_05_resources_files/libs/quarto-contrib/videojs/video-js.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#purpose" id="toc-purpose" class="nav-link active" data-scroll-target="#purpose">Purpose</a></li>
  <li><a href="#step-1.-read-introduction" id="toc-step-1.-read-introduction" class="nav-link" data-scroll-target="#step-1.-read-introduction">Step 1. Read Introduction</a>
  <ul class="collapse">
  <li><a href="#step-2.-download-and-review-exercise-spreadsheet-and-answer-template" id="toc-step-2.-download-and-review-exercise-spreadsheet-and-answer-template" class="nav-link" data-scroll-target="#step-2.-download-and-review-exercise-spreadsheet-and-answer-template">Step 2. Download and review exercise spreadsheet and answer template</a></li>
  <li><a href="#step-3.-compare-vehicle-costs-per-mile-by-mode" id="toc-step-3.-compare-vehicle-costs-per-mile-by-mode" class="nav-link" data-scroll-target="#step-3.-compare-vehicle-costs-per-mile-by-mode">Step 3. Compare Vehicle Costs per Mile by Mode</a></li>
  <li><a href="#step-4.-estimate-per-passenger-costs" id="toc-step-4.-estimate-per-passenger-costs" class="nav-link" data-scroll-target="#step-4.-estimate-per-passenger-costs">Step 4. Estimate Per-Passenger Costs</a></li>
  <li><a href="#step-5.-estimate-tdm-benefits" id="toc-step-5.-estimate-tdm-benefits" class="nav-link" data-scroll-target="#step-5.-estimate-tdm-benefits">Step 5. Estimate TDM Benefits</a></li>
  <li><a href="#step-6.-scenario-building" id="toc-step-6.-scenario-building" class="nav-link" data-scroll-target="#step-6.-scenario-building">Step 6. Scenario Building</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">GEO 3/430 Exercise #5</h1>
<p class="subtitle lead">Transportation Costs and Benefits</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>C. Scott Smith, PhD AICP (Instructor) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 6, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="purpose" class="level2">
<h2 class="anchored" data-anchor-id="purpose">Purpose</h2>
<p>Over the past several weeks, the class has examined various conventional categories of travel modes: walking, bicycling, public transit and automobile. This exercise asks you to examine the societal costs and benefits of different travel scenarios, taken into account various characteristics of each mode. For this, we will make extensive use of the <a href="https://www.vtpi.org/tca/">Transportation Cost and Benefit Analysis: Techniques, Estimates and Implications</a> guidebook published by the <a href="http://www.vtpi.org/tca">Victoria Transport Policy Institute</a>. The document, authored by Todd Litman <span class="citation" data-cites="litman2009">(<a href="#ref-litman2009" role="doc-biblioref">Litman 2009</a>)</span>, categorizes costs with respect to various attributes, including internal or external, fixed or variable, market or nonmarket costs and/or benefits.</p>
</section>
<section id="step-1.-read-introduction" class="level1">
<h1>Step 1. Read Introduction</h1>
<p>The first step is to read the introductory chapter of the guidebook, paying special attention to section 1.5 about cost.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Related Documents by the Victoria Transport Policy Institute
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The Victoria Transport Policy Institute has also published other related reports on topics such as: <em>Evaluating Public Transit Benefits and Costs: Best Practices Guidebook</em> <span class="citation" data-cites="toddlitman2017">(<a href="#ref-toddlitman2017" role="doc-biblioref">Todd Litman 2017</a>)</span>; <em>Transportation Cost and Benefit Analysis–Parking Costs</em> <span class="citation" data-cites="toddlitman2019">(<a href="#ref-toddlitman2019" role="doc-biblioref">Todd Litman 2019</a>)</span>; <em>Evaluating Transportation Equity: Guidance For Incorporating Distributional Impacts in Transportation Planning</em> <span class="citation" data-cites="litman2014">(<a href="#ref-litman2014" role="doc-biblioref">Litman 2014</a>)</span>; and <em>Evaluating Active Transport Benefits and Costs Guide to Valuing Walking and Cycling Improvements and Encouragement Programs</em> <span class="citation" data-cites="litman2015">(<a href="#ref-litman2015" role="doc-biblioref">Litman 2015</a>)</span>.</p>
</div>
</div>
</div>
<section id="step-2.-download-and-review-exercise-spreadsheet-and-answer-template" class="level2">
<h2 class="anchored" data-anchor-id="step-2.-download-and-review-exercise-spreadsheet-and-answer-template">Step 2. Download and review exercise spreadsheet and answer template</h2>
<p>Download the Transportation Cost Analysis Spreadsheets Excel spreadsheet, <a href="https://justenvirons.github.io/pedagogy/exercises_transportation/data/TransportationCostsBenefits_Modified_2016.xlsx">TransportationCostsBenefits_2016.xlsx</a>, from the course GitHub folder. Review the worksheets (tabs) in the spreadsheet. Also, <a href="https://justenvirons.github.io/pedagogy/exercises_transportation/slides/Exercise05_Template.pptx">download the template</a> for exercise #5 which is also located on the course GitHub. Submit the completed exercise to the associated folder on D2L.</p>
</section>
<section id="step-3.-compare-vehicle-costs-per-mile-by-mode" class="level2">
<h2 class="anchored" data-anchor-id="step-3.-compare-vehicle-costs-per-mile-by-mode">Step 3. Compare Vehicle Costs per Mile by Mode</h2>
<p>In this step, you will estimate vehicle costs per mile by transportation mode. The <em>Defaults</em> worksheet contains default per vehicle-mile cost estimates. Feel free to change the <em>Distribution of Vehicle Travel</em> (rows 106-109) to reflect the type of travel taking place in your area of interest. Be sure the percentages you enter sum to 100% (e.g., Urban Peak 75%; Urban Off-Peak 25%; Rural 0%).</p>
<p>The <em>Per-Vehicle Costs</em> worksheet contains cost estimates per vehicle-mile. The default units are in 2007 US dollars per mile. Your first task is to update the estimates so that they are reported in current (i.e., 2023) dollars. Do this by changing the inflation rate in cell B14 to 52%. This conversion was made using <a href="https://data.bls.gov/cgi-bin/cpicalc.pl?cost1=1.00&amp;year1=200701&amp;year2=202401">the BLS calculator</a>.</p>
<p>In the Per-Vehicle Costs worksheet, review Table 4 Average Travel. Compare the internal fixed, internal variable, and external costs for each of the 11 modes of transportation. <em>In slide 1 of your presentation, report the total costs per mile (in current dollars) for the average car, compact car, electric car, bicycle and walk modes. Now compare the various categories of costs (e.g., health benefits, air pollution, greenhouse gas emissions GHG) between these modes. Also how do these costs differ by type of travel (i.e., urban peak, urban off-peak and rural travel, tables 1-3)? What do these per mile costs suggest about the potential roles of electric cars and non-motorized modes of transportation for advancing sustainable transportation?</em></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
VIDEO
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="quarto-video"><video id="video_shortcode_videojs_video1" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="videos/Exercise_05_01.mp4"></video></div>
</div>
</div>
</div>
</section>
<section id="step-4.-estimate-per-passenger-costs" class="level2">
<h2 class="anchored" data-anchor-id="step-4.-estimate-per-passenger-costs">Step 4. Estimate Per-Passenger Costs</h2>
<p>Now open the <em>Per-Passenger Costs worksheet</em> which tabulates costs per passenger-mile, calculated by multiplying per-vehicle costs by average vehicle occupancy values. <em>Compare the total costs per-vehicle mile with the per-passenger mile costs for Diesel Bus and Electric Trolley modes. Why are they so different? How do the costs associated with bus and trolley mass transit differ from those incurred from rideshare passengers during urban peak travel times? What is the percentage of per passenger mile cost savings if diesel buses had greater average occupancies, say 30 instead of 25 passengers during urban peak hour travel? Change the default Average Occupancy value in the Per-Passenger Costs worksheet for Diesel Bus urban peak travel (cell G32) to find out. Write your responses to the above questions in slide 2 of your presentation.</em></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
VIDEO
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="quarto-video"><video id="video_shortcode_videojs_video2" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="videos/Exercise_05_02.mp4"></video></div>
</div>
</div>
</div>
</section>
<section id="step-5.-estimate-tdm-benefits" class="level2">
<h2 class="anchored" data-anchor-id="step-5.-estimate-tdm-benefits">Step 5. Estimate TDM Benefits</h2>
<p>Refer to the <em>TDM (or travel demand management) Benefits</em> worksheet. These are estimated benefits from travel shifts, calculated based on the difference in costs between “Average Automobile” and other modes. Refer to Table 4. Average Modes in this worksheet. <em>Which modes offer the greatest total benefits over the average automobile? Do you agree with these assessments? Explain your answer, referencing how specific modes perform with respect to detailed benefits categories (travel time, etc.). Write your responses in slide 3 of your presentation.</em></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
VIDEO
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="quarto-video"><video id="video_shortcode_videojs_video3" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="videos/Exercise_05_03.mp4"></video></div>
</div>
</div>
</div>
</section>
<section id="step-6.-scenario-building" class="level2">
<h2 class="anchored" data-anchor-id="step-6.-scenario-building">Step 6. Scenario Building</h2>
<p>Imagine now that people in your neighborhood collectively travel approximately 10,000 miles per day. Estimate the total benefits (in current dollars) if 85 percent of the total miles were traveled using an average car, and other shares as represented in the <em>Scenario</em> worksheet. <em>Note the total daily benefits (in dollars) this scenario has relative to the same distance traveled by an average car.</em></p>
<p>Now assume that plans, programs and policies encouraged a mode shift such that 2.5 percent of miles by average car were replaced by diesel bus trips and another 5 percent of average car miles were replaced by a combination of bicycle and walk miles. <em>Provide the total cost savings for this alternative scenario in slide 4.</em></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
VIDEO
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="quarto-video"><video id="video_shortcode_videojs_video4" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="videos/Exercise_05_04.mp4"></video></div>
</div>
</div>
</div>

</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-litman2009" class="csl-entry" role="listitem">
Litman, Todd. 2009. <span>“Transportation <span>Cost</span> and <span>Benefit Analysis Techniques</span>, <span>Estimates</span> and <span>Implications</span>.”</span> <span>Victoria Transport Policy Institute</span>. <a href="https://www.vtpi.org/tca/">https://www.vtpi.org/tca/</a>.
</div>
<div id="ref-litman2014" class="csl-entry" role="listitem">
———. 2014. <span>“Evaluating <span>Transportation Equity</span>: <span>Guidance For Incorporating Distributional Impacts</span> in <span>Transportation Planning</span>.”</span> <span>Victoria Transport Policy Institute</span>. <a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0CCMQFjAA&amp;url=http%3A%2F%2Fwww.vtpi.org%2Fequity.pdf&amp;ei=87uEVMGxMsqryASkuYCYBw&amp;usg=AFQjCNFx1nVyeUkgaDYd6Kh7rJ3iSZCwVg&amp;sig2=ROgDPdsXG7TxvqrCvWGdmw&amp;bvm=bv.80642063,d.aWw">http://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0CCMQFjAA&amp;url=http%3A%2F%2Fwww.vtpi.org%2Fequity.pdf&amp;ei=87uEVMGxMsqryASkuYCYBw&amp;usg=AFQjCNFx1nVyeUkgaDYd6Kh7rJ3iSZCwVg&amp;sig2=ROgDPdsXG7TxvqrCvWGdmw&amp;bvm=bv.80642063,d.aWw</a>.
</div>
<div id="ref-litman2015" class="csl-entry" role="listitem">
———. 2015. <span>“Evaluating <span>Active Transport Benefits</span> and <span>Costs Guide</span> to <span>Valuing Walking</span> and <span>Cycling Improvements</span> and <span>Encouragement Programs</span>.”</span> <span>Victoria Transport Policy Institute</span>.
</div>
<div id="ref-toddlitman2017" class="csl-entry" role="listitem">
Todd Litman. 2017. <span>“Evaluating <span>Public Transit Benefits</span> and <span>Costs</span>: <span>Best Practices Guidebook</span>.”</span> <span>Victoria Transport Policy Institute</span>.
</div>
<div id="ref-toddlitman2019" class="csl-entry" role="listitem">
———. 2019. <span>“Transportation <span>Cost</span> and <span>Benefit Analysis</span>–<span>Parking Costs</span>.”</span> <a href="http://www.vtpi.org/tca/tca0504.pdf">http://www.vtpi.org/tca/tca0504.pdf</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>videojs(video_shortcode_videojs_video1);</script>
<script>videojs(video_shortcode_videojs_video2);</script>
<script>videojs(video_shortcode_videojs_video3);</script>
<script>videojs(video_shortcode_videojs_video4);</script>



</body></html>